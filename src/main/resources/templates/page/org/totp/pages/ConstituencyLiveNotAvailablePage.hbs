<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Top of the Poops | Constituency - Live Data | {{ constituency.name }} | Not Available</title>
    <meta name="description" content="Live sewage dump information for {{ constituency.name }}">

    {{> chunks/favicons }}
    {{> chunks/meta-styles }}
    {{> chunks/meta-scripts }}
    {{> chunks/meta-leaflet }}

    <link rel="canonical" href="{{ uri  }}"/>

    <style>
        .map {
            min-height: 500px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .card {
            transition: all 0.3s ease;
            border: none;
        }
    </style>

    {{> components/meta-opengraph
            title=(concat "Live Sewage | " constituency.name " | Not Available")
            twitterImageUri=share.twitterImageUri
    }}
</head>
<body>
{{> chunks/navbar }}

{{#> components/jumbotron }}
    <div class="text-center">
        <h1 class="display-4 fw-bold">{{ constituency.name }}</h1>
        <p class="lead fs-4">
            Sorry we don't have live sewage information for this constituency yet
        </p>
    </div>
{{/components/jumbotron}}

<div class="container-fluid py-4">
    <div class="row g-4">
        <div class="col-md-8">
            <div class="card border-0 shadow-sm">
                <div class="card-body p-0">
                    <div id="map" class="map">
                        <div style="display:none" data-map-attribution>
                            &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors
                            <br/>
                            Contains OS Data &copy; Crown copyright &amp; database right 2021-2024<br/>
                            &copy; <a href="https://top-of-the-poops.org">Top of the Poops</a> 2021-2024
                        </div>
                    </div>
                    <div style="display: none" id="map-geojson">{{geojson}}</div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-primary text-white">
                    <h2 class="h5 mb-0"><i class="bi bi-geo-alt-fill me-2"></i>Select Another Constituency</h2>
                </div>
                <div class="card-body">
                    <form>
                        <div class="form-group">
                            <label class="form-label fw-bold">Constituency</label>
                            <select class="form-select form-select-lg mb-2" name="constituency"
                                    id="constituency-select">
                                {{#each constituencies}}
                                    <option value="{{this.uri}}" {{#if this.current}}selected{{/if}}>{{#if this.live}}
                                        ‚úî {{else}}ùë• {{/if}}{{this.name}}</option>
                                {{/each}}
                            </select>
                            <script>
                                document.getElementById("constituency-select")
                                        .onchange = (e) => {
                                    window.location = e.target.value;
                                    return false;
                                }
                            </script>
                            <div class="form-text mb-1"><i class="bi bi-info-circle me-1"></i>Select the constituency
                                from the drop-down
                            </div>
                            <div class="form-text">‚úî means we have live data (ùë• if not)</div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container py-5">
    <div class="row">
        <div class="col">
            {{> chunks/plea }}
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <div class="col">{{> chunks/data-sources }}</div>
    </div>
</div>

{{> chunks/footer }}

<script type="module">

    import * as maps from '/assets/js/map-common.js';

    const myStyle = {
        "color": "#ff7800",
        "weight": 5,
        "opacity": 0.65
    };

    const map = L.map("map", {
        scrollWheelZoom: false,
        dragging: !L.Browser.mobile,
        tap: !L.Browser.mobile,
        maxZoom: 18,
        zoomSnap: 0.1
    });

    const gl = L.maplibreGL({
        style: maps.STYLE_URI,
        attribution: document.getElementById("map").querySelector("[data-map-attribution]").innerHTML
    }).addTo(map);

    const layer = L.geoJSON(JSON.parse(document.getElementById("map-geojson").textContent), {style: myStyle});
    layer.addTo(map);
    map.fitBounds(layer.getBounds());

</script>

</body>
</html>
